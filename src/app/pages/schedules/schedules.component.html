<div class="md:flex flex-none my-5 gap-3">
  <div
    *ngFor="let schedule of schedules; let i = index"
    class="md:col-4 lg:col-3 col-12"
  >
    <p-card
      *ngIf="rolePS"
      class="grid justify-content-center"
      [style]="{ width: '20rem' }"
    >
      <ng-template class="col align-self-center" pTemplate="title">
        <div class="grid mx-1 justify-content-between align-items-center">
          <p class="text-base">{{ schedule.clientName }}</p>
          <button
            class="p-button-rounded p-button-text p-button-secondary border-2 border-black-alpha-50 bg-secondary-100"
            pButton
            pRipple
            type="button"
            routerLink="/chat/{{ schedule.clientId }}"
            icon="pi pi-envelope"
            title="Chat"
          ></button>
        </div>
      </ng-template>
      <ng-template class="col" pTemplate="subtitle">
        <div *ngIf="!isCompleted(i)" class="grid mx-1 align-items-center">
          <span
            class="status-dot border-round"
            [ngStyle]="{ 'background-color': 'orange' }"
          ></span>
          <p class="m-0 ml-2">
            <small>{{ schedule.scheduleStatusName }}</small>
          </p>
          <p class="col-12 ml-2">
            <small>{{ schedule.payrollDate }}</small>
          </p>
        </div>
        <div *ngIf="isCompleted(i)" class="grid mx-1 align-items-center">
          <span
            class="status-dot border-round"
            [ngStyle]="{ 'background-color': 'green' }"
          ></span>
          <p class="m-0 ml-2">
            <small>{{ schedule.scheduleStatusName }}</small>
          </p>
          <p class="col-12 ml-2">
            <small>{{ schedule.payrollDate }}</small>
          </p>
        </div>
      </ng-template>
      <ng-template pTemplate="body"> </ng-template>
      <ng-template pTemplate="footer">
        <div class="grid mt-1 justify-content-between">
          <div class="md:col-5 col-6">
            <p-button
              [disabled]="isNoSchedule(i)"
              routerLink="/schedules/{{ schedule.clientAssignmentId }}"
              size="small"
              label="View"
              class="w-full"
              styleClass="w-full"
            />
          </div>
        </div>
      </ng-template>
    </p-card>
  </div>
  <div
    *ngFor="let clientSchedule of clientSchedules; let i = index"
    class="md:col-4 lg:col-3 col-12"
  >
    <p-card
      *ngIf="roleClient"
      class="grid justify-content-center"
      [style]="{ width: '20rem' }"
    >
      <ng-template class="grid justify-content-end" pTemplate="title">
        <p class="text-base font-medium ml-2 text-right">
          <small>{{ clientSchedule.payrollDate }}</small>
        </p>
      </ng-template>
      <ng-template class="col" pTemplate="subtitle">
        <div *ngIf="!isCompleted(i)" class="grid mx-1 align-items-center">
          <span
            class="status-dot border-round"
            [ngStyle]="{ 'background-color': 'orange' }"
          ></span>
          <p class="m-0 ml-2">
            <small>{{ clientSchedule.scheduleStatusName }}</small>
          </p>
        </div>
        <div *ngIf="isCompleted(i)" class="grid mx-1 align-items-center">
          <span
            class="status-dot border-round"
            [ngStyle]="{ 'background-color': 'green' }"
          ></span>
          <p class="m-0 ml-2">
            <small>{{ clientSchedule.scheduleStatusName }}</small>
          </p>
        </div>
      </ng-template>
      <ng-template pTemplate="body"> </ng-template>
      <ng-template pTemplate="footer">
        <div class="grid mt-1 justify-content-between">
          <div class="md:col-4 col-6">
            <p-button
              size="small"
              label="View"
              [disabled]="!clientSchedule.canBeRescheduled"
              routerLink="/payrolls/{{ clientSchedule.scheduleId }}"
              class="w-full"
              styleClass="w-full"
            />
          </div>
          <div class="col-6">
            <p-button
              (onClick)="showDialog(clientSchedule)"
              *ngIf="clientSchedule.canBeRescheduled"
              size="small"
              label="Reschedule"
              class="w-full"
              styleClass="w-full"
            />
          </div>
        </div>
      </ng-template>
    </p-card>
  </div>
</div>

<div class="card flex justify-content-center">
  <p-toast></p-toast>
  <p-dialog
    header="Reschedule"
    [modal]="true"
    [(visible)]="visible"
    [style]="{ width: '25rem' }"
  >
    <pre>
    {{ rescheduleForm.value | json }}
  </pre
    >

    <span class="p-text-secondary block mb-5"
      >Update your Last Document Deadline.</span
    >
    <div class="grid align-items-center gap-3 mb-3">
      <p-calendar
        autofocus="false"
        [iconDisplay]="'input'"
        [maxDate]="maxDate"
        [minDate]="minDate"
        dateFormat="dd/mm/yy"
        (onSelect)="onDateSelect($event)"
        appendTo="body"
        [showIcon]="true"
        inputId="icondisplay"
        class="w-full"
        styleClass="w-full"
      />
    </div>
    <div class="grid justify-content-end gap-2">
      <p-button label="Cancel" severity="secondary" (click)="visible = false" />
      <p-confirmPopup />
      <p-button
        label="Save"
        [disabled]="rescheduleForm.invalid"
        (click)="confirm($event)"
      ></p-button>
    </div>
  </p-dialog>
</div>
